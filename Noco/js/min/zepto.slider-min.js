!function($,t){$.ui.define("slider",{_data:{viewNum:1,imgInit:2,itemRender:null,imgZoom:!1,loop:!1,stopPropagation:!1,springBackDis:15,autoPlay:!0,autoPlayTime:4e3,animationTime:400,showArr:!0,showDot:!0,slide:null,slideend:null,index:0,_stepLength:1,_direction:1},_create:function(){var t=this,e=0,i,a=[],o=t.data("content");t._initConfig(),(t.root()||t.root($("<div></div>"))).addClass("ui-slider").appendTo(t.data("container")||(t.root().parent().length?"":document.body)).html('<div class="ui-slider-wheel"><div class="ui-slider-group">'+function(){if(t.data("itemRender"))for(var s=t.data("itemRender");i=s.call(t,e++);)a.push('<div class="ui-slider-item">'+i+"</div>");else for(;i=o[e++];)a.push('<div class="ui-slider-item"><a href="'+i.href+'"><img lazyload="'+i.pic+'"/></a>'+(i.title?"<p>"+i.title+"</p>":"")+"</div>");return a.push(t.data("loop")?'</div><div class="ui-slider-group">'+a.join("")+"</div></div>":"</div></div>"),a.join("")}()),t._addDots()},_setup:function(t){var e=this,i=e.root().addClass("ui-slider");if(e._initConfig(),t)e.data("loop")&&$(".ui-slider-wheel",i).append($(".ui-slider-group",i).clone());else{var a=i.children(),o=$('<div class="ui-slider-group"></div>').append(a.addClass("ui-slider-item"));i.empty().append($('<div class="ui-slider-wheel"></div>').append(o).append(e.data("loop")?o.clone():"")),e._addDots()}},_init:function(){var t=this,e=t.data("index"),i=t.root(),a=$.proxy(t._eventHandler,t);t._setWidth(),$(t.data("wheel")).on("touchstart touchmove touchend touchcancel webkitTransitionEnd",a),$(window).on("ortchange",a),$(".ui-slider-pre",i).on("tap",function(){t.pre()}),$(".ui-slider-next",i).on("tap",function(){t.next()}),t.on("destroy",function(){clearTimeout(t.data("play")),$(window).off("ortchange",a)}),t.data("autoPlay")&&t._setTimeout()},_initConfig:function(){var t=this._data;t.viewNum>1&&(t.loop=!1,t.showDot=!1,t.imgInit=t.viewNum+1)},_addDots:function(){var t=this,e=t.root(),i=$(".ui-slider-item",e).length/(t.data("loop")?2:1),a=[];if(t.data("showDot")){for(a.push('<p class="ui-slider-dots">');i--;)a.push("<b></b>");a.push("</p>")}t.data("showArr")&&a.push('<span class="ui-slider-pre"><b></b></span><span class="ui-slider-next"><b></b></span>'),e.append(a.join(""))},_setWidth:function(){var t=this,e=t._data,i=t.root(),a=Math.ceil(i.width()/e.viewNum),o=i.height(),s=e.loop,n=$(".ui-slider-item",i).toArray(),r=n.length,d=$(".ui-slider-wheel",i).width(a*r)[0],l=$(".ui-slider-dots b",i).toArray(),h=$("img",i).toArray(),u=h.concat(),c={},p,m,v=e.imgInit||r;for(e.showDot&&(l[0].className="ui-slider-dot-select"),e.imgZoom&&$(u).on("load",function(){var t=this.height,e=this.width,i=Math.min(t,o),s=Math.min(e,a);this.style.cssText+=t/o>e/a?"height:"+i+"px;width:"+i/t*e+"px;":"height:"+s/e*t+"px;width:"+s+"px",this.onload=null}),p=0;r>p;p++){var g="relative";0!=p&&(g="absolute"),n[p].style.cssText+="width:"+a+"px;position:"+g+";-webkit-transform:translate3d("+p*a+"px,0,0);z-index:"+(900-p),c[p]=s&&p>r/2-1?p-r/2:p,v>p&&(m=u.shift(),m&&(m.src=m.getAttribute("lazyload")),e.loop&&(m=h[p+r/2],m&&(m.src=m.getAttribute("lazyload"))))}return t.data({root:i[0],wheel:d,items:n,lazyImgs:u,allImgs:h,length:r,width:a,height:o,dots:l,dotIndex:c,dot:l[0]}),t},_eventHandler:function(t){var e=this;switch(t.type){case"touchmove":e._touchMove(t);break;case"touchstart":e._touchStart(t);break;case"touchcancel":case"touchend":e._touchEnd();break;case"webkitTransitionEnd":e._transitionEnd();break;case"ortchange":e._resize.call(e)}},_touchStart:function(t){var e=this;e.data({pageX:t.touches[0].pageX,pageY:t.touches[0].pageY,S:!1,T:!1,X:0}),e.data("wheel").style.webkitTransitionDuration="0ms"},_touchMove:function(t){var e=this._data,i=e.X=t.touches[0].pageX-e.pageX;if(!e.T){var a=e.index,o=e.length,s=Math.abs(i)<Math.abs(t.touches[0].pageY-e.pageY);e.loop&&(e.index=a>0&&o-1>a?a:a===o-1&&0>i?o/2-1:0===a&&i>0?o/2:a),s||clearTimeout(e.play),e.T=!0,e.S=s}e.S||(e.stopPropagation&&t.stopPropagation(),t.preventDefault(),e.wheel.style.webkitTransform="translate3d("+(i-e.index*e.width)+"px,0,0)")},_touchEnd:function(){var t=this,e=t._data;if(!e.S){var i=e.springBackDis,a=e.X<=-i?Math.ceil(-e.X/e.width):e.X>i?-Math.ceil(e.X/e.width):0;e._stepLength=Math.abs(a),t._slide(e.index+a)}},_slide:function(t,e){var i=this,a=i._data,o=a.length,s=o-a.viewNum+1;return t>-1&&s>t?i._move(t):t>=s?a.loop?(a.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+(o/2-1)*a.width+"px,0,0);",a._direction=1,$.later(function(){i._move(o/2)},20)):(i._move(s-(e?2:1)),a._direction=-1):(a.loop?(a.wheel.style.cssText+="-webkit-transition:0ms;-webkit-transform:translate3d(-"+o/2*a.width+"px,0,0);",$.later(function(){i._move(o/2-1)},20)):i._move(e?1:0),a._direction=1),i},_move:function(t){var e=this._data,i=e.dotIndex[t];if(this.trigger("slide",i),e.lazyImgs.length){var a=e.allImgs[t];a&&a.src||(a.src=a.getAttribute("lazyload"))}e.showDot&&(e.dot.className="",e.dots[i].className="ui-slider-dot-select",e.dot=e.dots[i]),e.index=t,e.wheel.style.cssText+="-webkit-transition:"+e.animationTime+"ms;-webkit-transform:translate3d(-"+t*e.width+"px,0,0);"},_transitionEnd:function(){var t=this,e=t._data;if(t.trigger("slideend",e.dotIndex[e.index]),e.lazyImgs.length){for(var i=e._stepLength,a=0;i>a;a++){var o=e.lazyImgs.shift();o&&(o.src=o.getAttribute("lazyload")),e.loop&&(o=e.allImgs[e.index+e.length/2],o&&!o.src&&(o.src=o.getAttribute("lazyload")))}e._stepLength=1}t._setTimeout()},_setTimeout:function(){var t=this,e=t._data;return e.autoPlay?(clearTimeout(e.play),e.play=$.later(function(){t._slide.call(t,e.index+e._direction,!0)},e.autoPlayTime),t):t},_resize:function(){var t=this,e=t._data,i=e.root.offsetWidth/e.viewNum,a=e.length,o=e.items;if(!i)return t;e.width=i,clearTimeout(e.play);for(var s=0;a>s;s++)o[s].style.cssText+="width:"+i+"px;-webkit-transform:translate3d("+s*i+"px,0,0);";return e.wheel.style.removeProperty("-webkit-transition"),e.wheel.style.cssText+="width:"+i*a+"px;-webkit-transform:translate3d(-"+e.index*i+"px,0,0);",e._direction=1,t._setTimeout(),t},pre:function(){var t=this;return t._slide(t.data("index")-1),t},next:function(){var t=this;return t._slide(t.data("index")+1),t},stop:function(){var t=this;return clearTimeout(t.data("play")),t.data("autoPlay",!1),t},resume:function(){var t=this;return t.data("_direction",1),t.data("autoPlay",!0),t._setTimeout(),t}})}(Zepto);